(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"29db":function(t,e,a){},"56c6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"models absolute fit flex items-stretch",staticStyle:{overflow:"hidden"}},[a("div",{staticClass:"fit column"},[a("q-toolbar",{staticClass:"col-auto row items-center"},[a("q-tabs",{staticClass:"model-machine-tabs q-pa-xs",attrs:{"inline-label":"",shrink:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-route-tab",{attrs:{label:"Applications",icon:"share",name:"applications",to:{name:"models"}}}),a("q-route-tab",{attrs:{label:"Machines",icon:"fas fa-server",name:"machines",to:{name:"machines"}}})],1),a("q-space"),a("div",{staticStyle:{flex:"0.1 0.5 10em"},attrs:{id:"sort-models-select"}},[a("q-select",{staticClass:"on-left",attrs:{dense:"",label:"Sort By",options:t.sortModelsByOptions,color:t.$q.dark.isActive?"secondary":"primary",filled:""},model:{value:t.sortModelsBy,callback:function(e){t.sortModelsBy=e},expression:"sortModelsBy"}})],1),a("q-btn",{attrs:{color:"positive",icon:"fas fa-plus"},on:{click:function(e){return t.startCreate()}}})],1),a("div",{staticClass:"col relative-position"},[a("q-resize-observer",{on:{resize:t.onResizeContent}}),a("q-scroll-area",{ref:"modelScrollArea",style:{height:t.footerVisible?100-t.footerHeight+"%":"100%",transition:t.footerTransitioning?"all "+t.footerTransitionDuration/1e3+"s":"unset"},attrs:{"thumb-style":{width:"5px"}}},[a("div",{staticClass:"q-pa-sm"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-grow text-h5 q-mb-md xs"},[t._v("\n                "+t._s("applications"==t.tab?"Applications":"Machines")+"\n              ")]),a("div",{staticStyle:{flex:"0.1 0.5 10em",position:"relative",top:"-0.5em"},attrs:{id:"sort-models-select-mobile"}},[a("q-select",{staticClass:"on-left",attrs:{dense:"",label:"Sort By",options:t.sortModelsByOptions,color:t.$q.dark.isActive?"secondary":"primary",filled:""},model:{value:t.sortModelsBy,callback:function(e){t.sortModelsBy=e},expression:"sortModelsBy"}})],1)]),a("transition-group",{attrs:{name:"model-group-trans",tag:"div"}},t._l(t.models,(function(e){return a("div",{key:e.id,staticClass:"q-mb-md full-width"},[a("q-toolbar",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"bg-primary text-white full-width",on:{click:function(a){return t.$set(t.modelsExpanded,e.id,!t.modelsExpanded[e.id])}}},[a("q-icon",{style:{color:e.statusIcon.color},attrs:{name:e.statusIcon.icon,size:"1.7em"}}),a("q-separator",{staticClass:"on-right",attrs:{vertical:"",color:"grey-6"}}),a("q-toolbar-title",{staticStyle:{flex:"1 1 0%"}},[a("span",[t._v("\n                      "+t._s(e.name)+"\n                      "),a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle"}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])],1)]),a("div",{staticClass:"avatar-stack"},t._l(e.applications,(function(e){return a("q-avatar",{key:e.id,attrs:{size:"2em"}},[a("q-img",{attrs:{src:e.charm.imageUrl}}),a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-style":"font-size: 0.8em;"}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])],1)})),1),a("q-btn",{staticStyle:{transition:"transform 0.2s"},style:{transform:t.modelsExpanded[e.id]?"rotateZ(180deg)":"none"},attrs:{round:"",dense:"",flat:"",icon:"arrow_downward"}}),a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"more_vert"},on:{click:function(t){t.stopPropagation()}}})],1),a("q-slide-transition",[t.modelsExpanded[e.id]?a("div",[a("q-tab-panels",{staticStyle:{"background-color":"hsla(0, 0%, 0%, 0)"},attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{staticClass:"q-pa-none",staticStyle:{overflow:"hidden"},attrs:{id:"model-"+e.id,name:"applications"}},[a("q-list",{attrs:{bordered:"",separator:""}},t._l(e.applications,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,staticClass:"row",attrs:{clickable:"",id:"application-"+e.id},on:{click:function(a){t.activeApplication=e,t.showFooter()}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{style:{color:e.statusIcon.color},attrs:{name:e.statusIcon.icon,size:"1.4em"}})],1),a("q-item-section",{attrs:{avatar:""}},[a("q-img",{staticStyle:{width:"2.5em"},attrs:{src:e.charm.imageUrl}})],1),a("q-item-section",[a("div",[t._v("\n                                "+t._s(e.name)+"\n                              ")]),a("div",{staticClass:"row reverse"},t._l(e.units,(function(i){return a("div",{key:i.id},[a("q-icon",{staticClass:"q-ma-xs",style:{color:i.statusIcon.color},attrs:{name:i.statusIcon.icon,size:"1.em"}}),a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-style":"font-size: 0.8rem;"}},[t._v("\n                                    "+t._s(i.status.message||"status: "+i.status.severity)+"\n                                  ")]),a("q-menu",{attrs:{"context-menu":"","auto-close":""}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(a){return t.openLogs(i,e)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-file-alt"}})],1),a("q-item-section",[t._v("\n                                          Open Logs\n                                        ")])],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(a){return t.openTerminal(i,e)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-terminal"}})],1),a("q-item-section",[t._v("\n                                          Open Terminal\n                                        ")])],1)],1)],1)],1)})),0)]),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"more_vert"},on:{click:function(t){t.stopPropagation()}}})],1)],1)})),1)],1),a("q-tab-panel",{attrs:{name:"machines"}},[a("div",{staticClass:"text-h5"},[t._v("Machine List Comming Soon!")])])],1)],1):t._e()])],1)})),0)],1)]),"applications"==t.tab?a("div",{staticClass:"relative-position",style:{height:t.footerVisible?t.footerHeight+"%":"0%",transition:t.footerTransitioning?"all "+t.footerTransitionDuration/1e3+"s":"unset"}},[t.activeApplication&&(t.footerVisible||t.footerTransitioning)?a("div",{staticClass:"absolute fit column overflow-hidden"},[a("div",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse.up.down.prevent",value:t.resizeFooter,expression:"resizeFooter",modifiers:{mouse:!0,up:!0,down:!0,prevent:!0}}],staticStyle:{position:"absolute",left:"0",right:"0",top:"0",cursor:"ns-resize",height:"0.7em"}}),a("q-bar",{staticClass:"col-auto bg-primary text-white top-border",attrs:{dense:""}},[a("img",{staticStyle:{height:"1em"},attrs:{src:t.activeApplication.charm.imageUrl,ratio:1}}),a("div",{staticClass:"text-weight-bold ellipsis"},[t._v("\n              "+t._s(t.activeApplication.name)+"\n            ")]),a("q-space"),a("q-btn",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{dense:"",flat:"",icon:"fas fa-window-minimize"},on:{click:function(e){return t.hideFooter()}}},[a("q-tooltip",{attrs:{"transition-show":"jump-up","transition-hide":"jump-down",anchor:"top middle",self:"bottom middle",delay:300}},[t._v("\n                Hide\n              ")])],1)],1),a("div",{staticClass:"col-grow relative-position"},[a("q-scroll-area",{staticClass:"absolute fit",attrs:{"thumb-style":{width:"5px"}}},[a("q-table",{staticStyle:{"border-radius":"0px","box-shadow":"none","margin-bottom":"-3em"},attrs:{dense:"","hide-bottom":"",data:t.activeApplication.units,columns:t.activeApplicationUnitsColumns,pagination:{rowsPerPage:0},grid:t.$q.screen.xs,"row-key":"index","virtual-scroll":"","binary-state-sort":""},scopedSlots:t._u([{key:"body-cell-agent-status",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("div",[a("q-badge",{attrs:{color:t.unitAgentStatusBadgeColor(e.value),label:e.value}})],1)])]}},{key:"body-cell-actions",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-btn",{attrs:{dense:"",flat:"",size:"0.8em",icon:"fas fa-file-alt"},on:{click:function(a){return t.openLogs(e.value,t.activeApplication)}}},[a("q-tooltip",[t._v("Open Logs")])],1),a("q-btn",{attrs:{dense:"",flat:"",size:"0.8em",icon:"fas fa-terminal"},on:{click:function(a){return t.openTerminal(e.value,t.activeApplication)}}},[a("q-tooltip",[t._v("Open Terminal")])],1)],1)]}},{key:"body-cell-status",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("div",[a("q-badge",{attrs:{color:t.unitStatusSeverityBadgeColor(e.value),label:e.value}})],1)])]}},{key:"item",fn:function(e){return[a("div",{staticClass:"column col-6"},[a("q-card",{staticClass:"q-ma-xs"},[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t._v("\n                            "+t._s(e.cols.filter((function(t){return"name"==t.name}))[0].value)+"\n                          ")]),a("div",{staticClass:"col",staticStyle:{"text-align":"right"}},t._l([e.cols.filter((function(t){return"status"==t.name}))[0].value],(function(e){return a("q-badge",{key:e,attrs:{color:t.unitStatusSeverityBadgeColor(e)}},[t._v("\n                              "+t._s(e)+"\n                            ")])})),1)])]),a("q-separator"),a("q-list",{attrs:{dense:""}},t._l(e.cols.filter((function(t){return"name"!==t.name&&"status"!==t.name&&t.name})),(function(e){return a("q-item",{key:e.name},[a("q-item-section",[a("q-item-label",[t._v(t._s(e.label))]),"message"==e.name?a("q-item-label",{attrs:{caption:""}},[t._v("\n                              "+t._s(e.value)+"\n                            ")]):t._e()],1),"message"!=e.name?a("q-item-section",{attrs:{side:""}},[a("q-item-label",{attrs:{caption:""}},["actions"!=e.name?a("span",[t._v("\n                                "+t._s(e.value)+"\n                              ")]):a("span",[a("q-btn",{staticClass:"q-ma-xs",attrs:{dense:"",flat:"",size:"1em",icon:"fas fa-file-alt"},on:{click:function(a){return t.openLogs(e.value)}}},[a("q-tooltip",[t._v("Open Logs")])],1),a("q-btn",{staticClass:"q-ma-xs",attrs:{dense:"",flat:"",size:"1em",icon:"fas fa-terminal"},on:{click:function(a){return t.openTerminal(e.value)}}},[a("q-tooltip",[t._v("Open Terminal")])],1)],1)])],1):t._e()],1)})),1)],1)],1)]}}],null,!1,2585983293)})],1)],1)],1):t._e()]):t._e()],1)],1),a("juju-loading",{attrs:{loading:t.loading}})],1)},o=[],s=a("b7b1"),n=a("60a3"),r=a("4bb5"),l=a("fb60");const c={icon:"fas fa-check-circle",color:"var(--q-color-positive)"},d={icon:"fas fa-exclamation-triangle",color:"var(--q-color-warning)"},p={icon:"fas fa-exclamation-circle",color:"var(--q-color-negative)"},u={icon:"fas fa-circle",color:"var(--q-color-positive)"},m={icon:"fas fa-circle",color:"var(--q-color-warning)"},f={icon:"fas fa-circle",color:"var(--q-color-negative)"};function h(t,e){const a=l["a"][t];return a>=l["a"].blocked?e?f:p:a>=l["a"].maintenance?e?m:d:e?u:c}function v(t){return Object.assign({statusIcon:h(t.status.severity,!0)},t)}function b({units:t,store:e},a){const i=t.filter(t=>t.applicationId==a.id).map(v).sort((t,e)=>l["a"][e.status.severity]-l["a"][t.status.severity]),o=i.map(t=>t.status.severity)[0];return Object.assign({charm:e.filter(t=>t.id==a.charmId)[0],units:i,statusIcon:h(o),statusSeverity:o},a)}var g=a("b2da"),y=a("b444"),q=a("6260"),w=a("0831"),S=a("f303"),C=a("18d6"),_=function(t,e,a,i){var o,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,i);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(n=(s<3?o(n):s>3?o(e,a,n):o(e,a))||n);return s>3&&n&&Object.defineProperty(e,a,n),n},T=function(t,e,a,i){function o(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,s){function n(t){try{l(i.next(t))}catch(e){s(e)}}function r(t){try{l(i["throw"](t))}catch(e){s(e)}}function l(t){t.done?a(t.value):o(t.value).then(n,r)}l((i=i.apply(t,e||[])).next())}))};const x=Object(r["a"])("juju"),k=Object(r["a"])("app"),{offset:Q}=S["c"],{setScrollPosition:A}=w["a"],O="sortModelsBy";let j=class extends n["d"]{constructor(){super(...arguments),this.loading=!1,this.sortModelsByOptions=["Status","Name"],this.sortModelsBy="Status",this.tab="applications",this.modelsExpanded={},this.activeApplication=null,this.pageHeight=0,this.footerVisible=!1,this.footerHeight=50,this.footerTransitioning=!1,this.footerTransitionDuration=300}created(){return T(this,void 0,void 0,(function*(){const t=C["a"].getItem(O);!t||"Status"!=t&&"Name"!=t||(this.sortModelsBy=t),yield this.fetchData(),this.scrollToApp()}))}fetchData(){return T(this,void 0,void 0,(function*(){this.loading=!0,yield this.loadAllState(),this.loading=!1}))}get activeApplicationUnitsColumns(){return[{name:"name",label:"Unit",field:"index",align:"left",format:t=>`${this.activeApplication.name}/${t}`,sortable:!0},{name:"actions",label:"Actions",alight:"left",field:t=>t},{name:"agent-status",label:"Workload",field:"agentStatus",align:"left",sortable:!0},{name:"status",label:"Status",field:t=>t.status.severity,sort:(t,e)=>l["a"][e]-l["a"][t],align:"left",sortable:!0},{name:"message",label:"Message",align:"left",field:t=>t.status.message},{name:"machine",label:"Machine",field:"machineId",format:t=>this.machines.filter(e=>e.id==t)[0].index,align:"left",sortable:!0},{name:"public-ip",label:"Public IP",field:"machineId",format:t=>this.machines.filter(e=>e.id==t)[0].publicIp,align:"left",sortable:!0},{name:"exposed-ports",label:"Exposed Ports",field:"exposedPorts",align:"left",format:t=>t.join(", "),sortable:!0}]}unitAgentStatusBadgeColor(t){return"idle"==t?"positive":"active"==t?"warning":"negative"}unitStatusSeverityBadgeColor(t){const e=l["a"][t];return e==l["a"].active?"positive":l["a"].active<e&&e<l["a"].blocked?"warning":"negative"}onResizeContent({height:t}){this.pageHeight=t}resizeFooter(t){const e=t.delta.y,a=e/this.pageHeight*100,i=this.footerHeight-a;i>100?this.footerHeight=100:i<2?(this.footerVisible=!1,this.footerHeight=50):this.footerHeight=i}hideFooter(){this.footerTransitioning=!0,this.footerVisible=!1,setTimeout(()=>this.footerTransitioning=!1,this.footerTransitionDuration)}showFooter(){this.footerTransitioning=!0,this.footerVisible=!0,setTimeout(()=>this.footerTransitioning=!1,this.footerTransitionDuration)}onSortModelsByChange(t){C["a"].set(O,t)}scrollToElement(t){const e=this.$refs.modelScrollArea,a=e.getScrollTarget(),i=e.getScrollPosition(),o=Q(t).top,s=i+o-122,n=100;A(a,s,n)}get models(){const t=[];for(const e of this.controllerModels){const a=this.applications.filter(t=>t.modelId==e.id).map(t=>b({units:this.units,store:this.charmStore},t)),i=a.map(t=>t.statusSeverity).sort((t,e)=>l["a"][e]-l["a"][t])[0];t.push(Object.assign({applications:a,statusIcon:h(i),statusSeverity:i},e))}return t.sort((t,e)=>"Status"==this.sortModelsBy?l["a"][e.statusSeverity]-l["a"][t.statusSeverity]:t.name>e.name?1:-1)}scrollToApp(){const t=this.$route.query.unitId;if(!t)return;const e=this.units.filter(e=>e.id==t)[0],a=this.applications.filter(t=>t.id==e.applicationId)[0];this.$set(this.modelsExpanded,a.modelId,!0),setTimeout(function t(){const e=document.getElementById("application-"+a.id);e?this.scrollToElement(e):setTimeout(t,100)}.bind(this),200),this.footerVisible=!0,this.activeApplication=b({units:this.units,store:this.charmStore},a)}openLogs(t,e){this.addFloatingWindow({unit:t,app:e,kind:y["a"].log})}openTerminal(t,e){this.addFloatingWindow({unit:t,app:e,kind:y["a"].terminal})}};_([x.State],j.prototype,"currentController",void 0),_([x.Getter],j.prototype,"controllerModels",void 0),_([x.State("store")],j.prototype,"charmStore",void 0),_([x.State],j.prototype,"applications",void 0),_([x.State],j.prototype,"machines",void 0),_([x.State],j.prototype,"units",void 0),_([k.Action(q["a"].addFloatingWindow)],j.prototype,"addFloatingWindow",void 0),_([x.Action(g["a"].loadAllState)],j.prototype,"loadAllState",void 0),_([Object(n["e"])("sortModelsBy")],j.prototype,"onSortModelsByChange",null),_([Object(n["e"])("$route")],j.prototype,"scrollToApp",null),j=_([Object(n["a"])({components:{JujuLoading:s["a"]}})],j);var B=j,I=B,L=(a("ca6e"),a("2877")),M=a("65c6"),z=a("429b"),P=a("7867"),H=a("2c91"),R=a("ddd8"),$=a("9c40"),E=a("3980"),F=a("4983"),D=a("0016"),N=a("eb85"),V=a("6ac5"),U=a("05c0"),W=a("cb32"),J=a("068f"),G=a("e9c1"),Z=a("adad"),K=a("823b"),X=a("1c1c"),Y=a("66e5"),tt=a("4074"),et=a("4e73"),at=a("d847"),it=a("eaac"),ot=a("db86"),st=a("58a8"),nt=a("f09f"),rt=a("a370"),lt=a("0170"),ct=a("7460"),dt=a("714f"),pt=a("75c3"),ut=a("eebe"),mt=a.n(ut),ft=Object(L["a"])(I,i,o,!1,null,null,null);e["default"]=ft.exports;mt()(ft,"components",{QToolbar:M["a"],QTabs:z["a"],QRouteTab:P["a"],QSpace:H["a"],QSelect:R["a"],QBtn:$["a"],QResizeObserver:E["a"],QScrollArea:F["a"],QIcon:D["a"],QSeparator:N["a"],QToolbarTitle:V["a"],QTooltip:U["a"],QAvatar:W["a"],QImg:J["a"],QSlideTransition:G["a"],QTabPanels:Z["a"],QTabPanel:K["a"],QList:X["a"],QItem:Y["a"],QItemSection:tt["a"],QMenu:et["a"],QBar:at["a"],QTable:it["a"],QTd:ot["a"],QBadge:st["a"],QCard:nt["a"],QCardSection:rt["a"],QItemLabel:lt["a"],QTab:ct["a"]}),mt()(ft,"directives",{Ripple:dt["a"],TouchPan:pt["a"]})},b7b1:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-inner-loading",{attrs:{showing:t.showLoading}},[a("q-spinner-rings",{attrs:{size:"80%",color:t.$q.dark.isActive?"secondary":"primary"}})],1)},o=[],s=a("74f7"),n=a("792f"),r=a("60a3"),l=function(t,e,a,i){var o,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,i);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(n=(s<3?o(n):s>3?o(e,a,n):o(e,a))||n);return s>3&&n&&Object.defineProperty(e,a,n),n};let c=class extends r["d"]{constructor(){super(...arguments),this.showLoading=!1,this.showLoadingTimeoutHandle=null}created(){this.onLoadingChange(this.loading)}onLoadingChange(t){t||(this.showLoading=!1),!t&&this.showLoadingTimeoutHandle?clearTimeout(this.showLoadingTimeoutHandle):t&&!this.showLoadingTimeoutHandle&&(this.showLoadingTimeoutHandle=setTimeout(()=>this.showLoading=!0,this.delay))}};l([Object(r["c"])(Boolean)],c.prototype,"loading",void 0),l([Object(r["c"])({type:Number,default:300})],c.prototype,"delay",void 0),l([Object(r["e"])("loading")],c.prototype,"onLoadingChange",null),c=l([Object(r["a"])({components:{QInnerLoading:s["a"],QSpinnerRings:n["a"]}})],c);var d=c,p=d,u=a("2877"),m=a("eebe"),f=a.n(m),h=Object(u["a"])(p,i,o,!1,null,null,null);e["a"]=h.exports;f()(h,"components",{QInnerLoading:s["a"],QSpinnerRings:n["a"]})},ca6e:function(t,e,a){"use strict";var i=a("29db"),o=a.n(i);o.a}}]);